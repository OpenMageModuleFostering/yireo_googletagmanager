<?php
/**
 * GoogleTagManager plugin for Magento 
 *
 * @package     Yireo_GoogleTagManager
 * @author      Yireo (http://www.yireo.com/)
 * @copyright   Copyright (c) 2014 Yireo (http://www.yireo.com/)
 * @license     Open Software License
 */
?>
<?php if($this->isEnabled()) : ?>
<?php $order = $this->getOrder(); ?>
<?php if(!empty($order) && $order->getId() > 0) : ?>
    <?php $this->setAttribute('transactionId', $order->getIncrementId()); ?>
    <?php $this->setAttribute('transactionAffiliation', Mage::app()->getWebsite()->getName()); ?>
    <?php $this->setAttribute('transactionTotal', $order->getGrandTotal()); ?>
    <?php $this->setAttribute('transactionTax', $order->getGrandTotal() - $order->getSubtotal()); ?>
    <?php $this->setAttribute('transactionShipping', $order->getShippingAmount()); ?>
    <?php $this->setAttribute('transactionProducts', $this->getItemsAsJson()); ?>
<?php endif; ?>
<?php endif; ?>
